{% extends "home_base.html" %}

{% load static %}
{% block css_files %}

{% endblock %}


{% block main %}
<main class="main-wrapper">

    <!-- Header Start -->
    {% block header %}
    {% include 'home_page_partials/main_header.html' %}
    {% endblock  %}
    <!-- Header End -->

    {% block slider %}
    <!-- Slider Section Start -->
    <div class="slider-section slider-section-04">
        <div class="slider-wrapper" style="background-image: url({% static "home_page_app/images/home-education-center-hero-bg.jpg" %});">
            <div class="container">

                <div class="row gy-10 align-items-center">
                    <div class="col-lg-6">
                        <!-- Slider Caption Start -->
                        <div class="slider-caption-04" data-aos="fade-up" data-aos-duration="1000">
                            <h4 class="slider-caption-04__sub-title">FOR A BETTER FUTURE</h4>
                            <h2 class="slider-caption-04__main-title">Build An <span>Incredible</span> Learning Experience</h2>
                            <a href="#" class="slider-caption-04__btn btn btn-white btn-hover-primary">Find Courses</a>
                        </div>
                        <!-- Slider Caption End -->
                    </div>
                    <div class="col-lg-6">
                        
                        <!-- Slider Register Form Start -->
                        <div class="slider-register__box text-center" data-aos="fade-up" data-aos-duration="1000">

                            <h4 class="slider-register__title">Register for A Free Account <br> To Access To <span>{{all_courses_count}}+</span> Online Courses</h4>

                            <form id="sliderRegisterForm" method="post" action="{% url 'account_app:add_student_from_slider' %}">
                                {% csrf_token %}
                                <div class="slider-register__form">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-user"></i>
                                                <input type="text" class="form-control" placeholder="First Name" name="first_name" required>
                                                <div class="error-message text-danger" id="first_name_error"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-user"></i>
                                                <input type="text" class="form-control" placeholder="Middle Name" name="middle_name" required>
                                                <div class="error-message text-danger" id="middle_name_error"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-user"></i>
                                                <input type="text" class="form-control" placeholder="Last Name" name="last_name" required>
                                                <div class="error-message text-danger" id="last_name_error"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-envelope"></i>
                                                <input type="email" class="form-control" placeholder="Your Email" name="email_address" required>
                                                <div class="error-message text-danger" id="email_address_error"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-key"></i>
                                                <input type="password" class="form-control" placeholder="Password" name="password" required>
                                                <div class="error-message text-danger" id="password_error"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-key"></i>
                                                <input type="password" class="form-control" placeholder="Confirm Password" name="confirm_password" required>
                                                <div class="error-message text-danger" id="confirm_password_error"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-phone"></i>
                                                <input type="text" class="form-control" placeholder="Phone Number" name="phone_number" required>
                                                <div class="error-message text-danger" id="phone_number_error"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-venus-mars"></i>
                                                <select class="form-control" name="gender" required>
                                                    <option value="">-- choose gender --</option>
                                                    <option value="male">Male</option>
                                                    <option value="female">Female</option>
                                                </select>
                                                <div class="error-message text-danger" id="gender_error"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-calendar"></i>
                                                <input type="date" class="form-control" placeholder="Date of Birth" name="date_of_birth" required>
                                                <div class="error-message text-danger" id="date_of_birth_error"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="slider-register__input">
                                                <i class="fas fa-map"></i>
                                                <input type="text" class="form-control" placeholder="Address" name="address" required>
                                                <div class="error-message text-danger" id="address_error"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slider-register__input">
                                        <i class="fas fa-graduation-cap"></i>
                                        <input type="text" class="form-control" name="major_or_department" placeholder="Major" required>
                                        <div class="error-message text-danger" id="major_error"></div>
                                    </div>
                                    <div class="slider-register__input">
                                        <input type="checkbox" name="terms" required>
                                        <label for="terms">I agree to the <a href="#">terms and conditions</a></label>
                                        <div class="error-message text-danger" id="terms_error"></div>
                                    </div>
                                    <div class="slider-register__btn">
                                        <button class="btn btn-primary btn-hover-secondary w-100" type="submit">
                                            <span class="btn-text">Sign up</span>
                                            <i class="fas fa-spinner fa-spin" style="display: none;"></i>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            
                            
                            
                            
                        </div>
                        <!-- Slider Register Form End -->

                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Slider Section End -->
    
    {% endblock  %}
 


    <!-- Offcanvas Start -->
    {% block offcanvas %}
    {% include "home_page_partials/offcanvas.html" %}
    {% endblock  %}
    <!-- Offcanvas End -->

   

    

        <!-- Footer Start -->
        {% block footer %}
        {% include 'home_page_partials/main_footer.html' %}
        {% endblock  %}
        <!-- Footer End -->
    
        {% include "home_page_partials/arrow_up_down.html" %}

        


</main>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.getElementById('sliderRegisterForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent default form submission

            const submitButton = event.target.querySelector('button[type="submit"]');
            const spinnerIcon = submitButton.querySelector('.fa-spinner');
            const btnText = submitButton.querySelector('.btn-text');

            // Show the spinner and hide the button text
            btnText.style.display = 'none';
            spinnerIcon.style.display = 'inline-block';

            // Create FormData object
            const formData = new FormData(event.target);

            // Submit form via fetch
            fetch(event.target.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': event.target.querySelector('[name=csrfmiddlewaretoken]').value,
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Redirect on success
                    window.location.href = data.redirect_url;
                } else {
                    // Reset button and display errors
                    btnText.style.display = 'inline';
                    spinnerIcon.style.display = 'none';
                    submitButton.disabled = false;
                    displayErrors(data.errors || {'error': data.error});
                }
            })
            .catch(error => {
                console.error('Error:', error);
                btnText.style.display = 'inline';
                spinnerIcon.style.display = 'none';
                submitButton.disabled = false;
                displayErrors({'error': 'An unexpected error occurred.'});
            });
        });

        // Function to display errors under the form fields
        function displayErrors(errors) {
            // Clear existing error messages
            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');

            // Display new error messages
            for (const [field, message] of Object.entries(errors)) {
                const errorElement = document.getElementById(`${field}_error`);
                if (errorElement) {
                    errorElement.textContent = message;
                }
            }
        }
    });
</script>


{% endblock %}
